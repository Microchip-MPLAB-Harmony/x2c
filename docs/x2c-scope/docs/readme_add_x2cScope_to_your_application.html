<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Add X2CScope to your MPLAB® Harmony 3 Application - Microchip MPLAB Harmony X2C help</title> <link rel="shortcut icon" href="../../favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="../../assets/css/just-the-docs.css"> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-2724382-16"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', "UA-2724382-16"); </script> <script type="text/javascript" src="../../assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="../../assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.6.1 --> <title>Add X2CScope to your MPLAB® Harmony 3 Application | Microchip MPLAB Harmony X2C help</title> <meta name="generator" content="Jekyll v3.9.0" /> <meta property="og:title" content="Add X2CScope to your MPLAB® Harmony 3 Application" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="Harmony 3 X2C package" /> <meta property="og:description" content="Harmony 3 X2C package" /> <link rel="canonical" href="../../x2c-scope/docs/readme_add_x2cScope_to_your_application.html" /> <meta property="og:url" content="../../x2c-scope/docs/readme_add_x2cScope_to_your_application.html" /> <meta property="og:site_name" content="Microchip MPLAB Harmony X2C help" /> <script type="application/ld+json"> {"@type":"WebPage","url":"../../x2c-scope/docs/readme_add_x2cScope_to_your_application.html","headline":"Add X2CScope to your MPLAB® Harmony 3 Application","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"../../assets/images/vendor/microchip_mplab_harmony_logo_150_transparent.png"}},"description":"Harmony 3 X2C package","@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="link" viewBox="0 0 16 16"> <title>Link</title> <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path> </symbol> </svg> <div class="page-wrap"> <div class="side-bar"> <div class="site-header"> <a href="../../index.html" class="site-title lh-tight"> <div class="site-logo"></div> </a> <button class="menu-button fs-3 js-main-nav-trigger" data-text-toggle="Hide" type="button">Menu</button> </div> <div class="navigation main-nav js-main-nav"> <nav role="navigation" aria-label="Main navigation"> <ul class="navigation-list"><li class="navigation-list-item"><a href="../../x2c_scope_license.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="../../mplab_harmony_license.html" class="navigation-list-link"></a></li><li class="navigation-list-item"><a href="../../release_notes.html" class="navigation-list-link"></a></li><li class="navigation-list-item active"><a href="../../index.html" class="navigation-list-link">MPLAB® Harmony X2C</a><ul class="navigation-list-child-list "><li class="navigation-list-item "><a href="../../x2c-model/docs/readme_installing_mh_x2c.html" class="navigation-list-link">Installing MPLAB Harmony X2C Remote Package</a></li><li class="navigation-list-item active"><a href="../../x2c-scope/docs/readme.html" class="navigation-list-link">X2CScope</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../x2c-scope/docs/readme_installing_x2cScope.html" class="navigation-list-link">Installing X2CScope plugin in MPLAB® X IDE</a> </li><li class="navigation-list-item active"> <a href="../../x2c-scope/docs/readme_add_x2cScope_to_your_application.html" class="navigation-list-link active">Add X2CScope to your MPLAB® Harmony 3 Application</a> </li></ul></li><li class="navigation-list-item "><a href="../../x2c-model/docs/readme.html" class="navigation-list-link">X2C Model</a><ul class="navigation-list-child-list"><li class="navigation-list-item "> <a href="../../x2c-model/docs/readme_installing_x2c_library.html" class="navigation-list-link">Installing X2C Library</a> </li><li class="navigation-list-item "> <a href="../../x2c-model/docs/readme_create_x2c_model_blinky_led.html" class="navigation-list-link">Create an X2C Model based "Bliky LED" demo in MPLAB® Harmony 3</a> </li></ul></li></ul></li></ul> </nav> </div> <footer class="site-footer"> <p class="text-small text-grey-dk-000 mb-4">This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll.</p> </footer> </div> <div class="main-content-wrap js-main-content" tabindex="0"> <div class="main-content"> <div class="page-header js-page-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" class="js-search-input search-input" tabindex="0" placeholder="Search Microchip MPLAB Harmony X2C help" aria-label="Search Microchip MPLAB Harmony X2C help" autocomplete="off"> <svg width="14" height="14" viewBox="0 0 28 28" xmlns="http://www.w3.org/2000/svg" class="search-icon"><title>Search</title><g fill-rule="nonzero"><path d="M17.332 20.735c-5.537 0-10-4.6-10-10.247 0-5.646 4.463-10.247 10-10.247 5.536 0 10 4.601 10 10.247s-4.464 10.247-10 10.247zm0-4c3.3 0 6-2.783 6-6.247 0-3.463-2.7-6.247-6-6.247s-6 2.784-6 6.247c0 3.464 2.7 6.247 6 6.247z"/><path d="M11.672 13.791L.192 25.271 3.02 28.1 14.5 16.62z"/></g></svg> </div> <div class="js-search-results search-results-wrap"></div> </div> <ul class="list-style-none text-small aux-nav"> <li class="d-inline-block my-0"><a href="https://support.microchip.com">Obtain Support from Microchip</a></li> </ul> </div> <div class="page"> <nav class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="../../index.html">MPLAB® Harmony X2C</a></li> <li class="breadcrumb-nav-list-item"><a href="../../x2c-scope/docs/readme.html">X2CScope</a></li> <li class="breadcrumb-nav-list-item"><span>Add X2CScope to your MPLAB® Harmony 3 Application</span></li> </ol> </nav> <div id="main-content" class="page-content" role="main"> <h1 id="add-x2cscope-to-your-mplab-harmony-3-application"> <a href="#add-x2cscope-to-your-mplab-harmony-3-application" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Add X2CScope to your MPLAB® Harmony 3 Application </h1> <p>This section provides a step by step guide to add X2CScope feature to ATSAMC21 based embedded application running on <a href="https://www.microchip.com/DevelopmentTools/ProductDetails/PartNO/MA320206">ATSAMC21 Motor Control Plugin Module</a> + <a href="https://www.microchip.com/developmenttools/ProductDetails/PartNo/DM330021-2?utm_source=MicroSolutions&amp;utm_medium=Article&amp;utm_content=DevTools&amp;utm_campaign=StandAlone">dsPICDEM™ MCLV-2 Development Board (Low Voltage)</a></p> <ul> <li> <p>Open ATSAMC21J18A based MPLAB Harmony Project to which X2CScope needs to be added.</p> </li> <li> <p>Open MPLAB® Harmony Configurator using Tools &gt; Plugin &gt; MPLAB® Harmony Configurator</p> </li> </ul> <p><img src="../../x2c-scope/docs/images/launch_mhc.png" alt="" /></p> <ul> <li> <p>Just like in a real oscilloscope, the X2CScope also has a sampling rate at which the global variables are captured/updated. In this example, we will be using a fixed frequency timer event using TC1 to set the sampling rate.</p> </li> <li> <p>Add TC1 from Available Components &gt; Peripherals &gt; TC into the Project</p> </li> </ul> <p><img src="../../x2c-scope/docs/images/Add_TC1.png" alt="" /></p> <ul> <li> <p>Configure the timer period of TC1 to be same as sampling rate of the X2CScope. Also enable the period match interrupt. In this example, the timer period is set to 50uS.</p> <p><img src="../../x2c-scope/docs/images/Configure_TC1.png" alt="" /></p> </li> <li> <p>X2CScope plugin communicates with the target MCU via UART. Add the appropriate UART channel which is mapped on the board to communicate with the host PC running the MPLAB X IDE. On <a href="https://www.microchip.com/DevelopmentTools/ProductDetails/PartNO/MA320206">ATSAMC21 Motor Control Plugin Module</a> + <a href="https://www.microchip.com/developmenttools/ProductDetails/PartNo/DM330021-2?utm_source=MicroSolutions&amp;utm_medium=Article&amp;utm_content=DevTools&amp;utm_campaign=StandAlone">dsPICDEM™ MCLV-2 Development Board (Low Voltage)</a> hardware setup, SERCOM3 can be configured as a UART channel which can communicate with the host PC.</p> </li> <li> <p>Add X2CScope component into the project and connect the UART port on X2CScope component to the UART port on SERCOM3 component. This configures X2CScope to user UART channel of SERCOM3 to communicate with X2CScope plugin on the host PC. Configure the recommended Baud Rate of 115200 bps using the X2CScope Component</p> <p><img src="../../x2c-scope/docs/images/connect_x2c_scope_sercom.png" alt="" /></p> </li> <li>Other than baud rate, following UART configurations are needed for establishing successful communication between target MCU and the host PC <ul> <li>Map the UART TXD and RXD signals (this configuration requirement may vary from MCU to MCU).In this example, TXD is mapped onto PAD[0] and RXD is mapped onto PAD[1]</li> <li>Set Transmit and Receive enable</li> <li>Disable UART Interrupts (disabled by default upon connecting X2CScope to the UART peripheral)</li> <li>Parity Mode - None (set by default)</li> <li>Character Size - 8 (set by default)</li> <li>Stop Bit - 1 (set by default)</li> <li>Baud Rate - Recommended to set at 115200 (configured by default upon connecting X2CScope to UART peripheral) <img src="../../x2c-scope/docs/images/uart_settings.png" alt="" /></li> </ul> </li> <li>Configure UART TX and RX pins using IO Pin Manager - MHC &gt; Tools &gt; Pin Configuration. In this example, PA22 is configured as SERCOM3_PAD0 [mapped as TXD] and PA23 is configured as SERCOM3_PAD1[mapped as RXD]</li> </ul> <p><img src="../../x2c-scope/docs/images/sercom_io_pinmap.png" alt="" /></p> <ul> <li>Generate Code</li> </ul> <p><img src="../../x2c-scope/docs/images/Generate_Code.png" alt="" /></p> <ul> <li>Adding X2CScope APIs <ul> <li>Open <code>main.c </code></li> <li> <p>Add <code>X2CScope_Communicate()</code> function call within the while(1) loop in the main function. This API establishes communication between the target MCU and the X2CScope plugin on the host PC.</p> <p><img src="../../x2c-scope/docs/images/add_x2cscope_communicate.png" alt="" /></p> </li> <li> <p><code>X2CScope_Update()</code> API samples the desired global variables. In order to sample the variables at a fixed rate (sampling rate), this API needs to be executed at the same rate as desired sampling rate. Typically, a timer is used to generate accurately timed interrupts which executes this API. In this example, TC1 is used to generate the sampling events and hence the <code>X2CScope_Update()</code> API is added in TC1 Interrupt Service Routine</p> <p><img src="../../x2c-scope/docs/images/add_x2cscope_update.png" alt="" /></p> </li> </ul> </li> <li>Enable symbol loading in MPLAB X guide <ul> <li>Go to File &gt; Project Properties &gt; Loading &gt; Enable “Load symbols when programming or building for production (slows process)” <img src="../../x2c-scope/docs/images/load_symbols.png" alt="" /></li> </ul> </li> <li> <p>Clean Build the project</p> <p><img src="../../x2c-scope/docs/images/clean_build.png" alt="" /></p> </li> <li> <p>Program the project into the target MCU</p> <p><img src="../../x2c-scope/docs/images/program.png" alt="" /></p> </li> </ul> <h1 id="running-x2cscope"> <a href="#running-x2cscope" class="anchor-heading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#link"></use></svg></a> Running X2CScope </h1> <ul> <li> <p>Launch X2CScope plugin : Tools &gt; Embedded &gt; X2CScope</p> <p><img src="../../x2c-scope/docs/images/launch_x2cscope.png" alt="" /></p> </li> <li> <p>Connecting X2CScope</p> <ul> <li>Connection setup <ul> <li>Select relevant MPLAB X Project</li> <li>Set Baud Rate same as UART channel - 115200 (recommended)</li> <li>Set Data bits - 8</li> <li>Set Parity - None</li> <li>Select relevant COM Port</li> </ul> </li> </ul> <p><img src="../../x2c-scope/docs/images/x2cscope_connection_setup.png" alt="" /></p> <ul> <li>Project setup <ul> <li>Set Scope Sample time to match timer period which executes <code>X2CScope_Update()</code> at a fixed rate</li> <li>Set Watch Sample time</li> <li>Click on “Set Values”</li> </ul> </li> </ul> <p><img src="../../x2c-scope/docs/images/x2cscope_project_setup.png" alt="" /></p> <ul> <li>Establish Connection by connecting “Disconnect/Connect” Toggle button</li> </ul> <p><img src="../../x2c-scope/docs/images/x2cscope_connected.png" alt="" /></p> <ul> <li>Using Scope View</li> </ul> <p><img src="../../x2c-scope/docs/images/open_scope_view.png" alt="" /></p> <ul> <li>Add the desired global variable to the corresponding channel and click “Sample”</li> </ul> <p><img src="../../x2c-scope/docs/images/x2c_scope_add_channel.png" alt="" /></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  ![](/x2c/x2c-scope/docs/images/x2cscope_running.png)
</code></pre></div> </div> <ul> <li>Using Watch View <ul> <li>Click on “Watch View” under “Data Views” tab.</li> <li>Click on “+” button to add the global variables to be watched</li> </ul> <p><img src="../../x2c-scope/docs/images/x2cscope_watch.png" alt="" /></p> </li> </ul> </li> </ul> <hr> <footer role="contentinfo"> <p class="text-small text-grey-dk-000 mb-0"><img src='../../assets/images/vendor/microchip_logo.png' /><br /> Copyright &copy; 2020 Microchip Technology.</p> </footer> </div> </div> </div> </div> </body> </html>
